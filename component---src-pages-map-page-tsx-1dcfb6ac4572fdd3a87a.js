(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{144:function(t,e,i){"use strict";i.r(e);var r=i(9),n=(i(0),i(265)),a=i.n(n),s=i(198),o=i.n(s),c=i(190),l=i.n(c),u=i(149),h=i.n(u),f=i(181),g=i.n(f),d=i(341),p=i(564),y=i(271),b=Object(p.a)([140.46,36.36],5e3,{units:"meters"});e.default=h()(function(t){return g()({root:{},autoSizerWrapper:{height:"calc(100vh - 56px)"}})})(function(t){return Object(r.d)("div",{className:t.classes.root},Object(r.d)(a.a,{position:"static"},Object(r.d)(o.a,null,Object(r.d)(l.a,{variant:"h6"},"Map Page"))),Object(r.d)("div",{className:t.classes.autoSizerWrapper},Object(r.d)(d.a,null,function(t){var e=t.width,i=t.height;return Object(r.d)(y.a,{width:e,height:i,feature:b})})))})},245:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xMiAyQzguMTMgMiA1IDUuMTMgNSA5YzAgNS4yNSA3IDEzIDcgMTNzNy03Ljc1IDctMTNjMC0zLjg3LTMuMTMtNy03LTd6bTAiIGZpbGw9IiMwMDkxRUEiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPHBhdGggZD0iTTEyIDExLjVjLTEuMzggMC0yLjUtMS4xMi0yLjUtMi41czEuMTItMi41IDIuNS0yLjUgMi41IDEuMTIgMi41IDIuNS0xLjEyIDIuNS0yLjUgMi41eiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zdmc+Cg=="},271:function(t,e,i){"use strict";i(55);var r=i(7),n=i.n(r),a=i(9),s=i(0),o=i(149),c=i.n(o),l=i(181),u=i.n(l),h=i(342),f=i(292),g=i.n(f),d=(i(244),i(293)),p=i.n(d),y=(i(38),i(80),i(61),i(81),i(37),i(294),i(295)),b=i.n(y),j=function(){function t(t){void 0===t&&(t={}),this.tileUrl=t.url||"//cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png",this.tileTree={}}var e=t.prototype;return e.treeIncludesTile=function(t){var e=t.x,i=t.y,r=t.z;return this.tileTree.hasOwnProperty(r.toString())&&this.tileTree[r.toString()].hasOwnProperty(e.toString())&&this.tileTree[r.toString()][e.toString()].hasOwnProperty(i.toString())},e.tile2tree=function(t){var e,i,r=t.x,n=t.y,a=t.z,s=t.url;if(this.tileTree.hasOwnProperty(a.toString()))if(this.tileTree[a.toString()].hasOwnProperty(r.toString()))this.tileTree[a.toString()][r.toString()][n.toString()]=s;else{var o;this.tileTree[a.toString()][r.toString()]=((o={})[n.toString()]=s,o)}else this.tileTree[a.toString()]=((i={})[r.toString()]=((e={})[n.toString()]=s,e),i)},e.fetchTiles=function(t){var e=this;return new Promise(function(i){var r=t.map(function(t){return e.fetchTile(t,e.tileUrl)});Promise.all(r).then(function(t){i(t)})})},e.fetchTile=function(t,e){var i=this,r=t.x,n=t.y,a=t.z,s=e.replace("{z}/{x}/{y}",a+"/"+r+"/"+n);return b()(s).then(function(t){if(!t.ok)throw new Error;return t.blob()}).then(function(e){var r=Object.assign({},t,{url:URL.createObjectURL(e)});return i.tile2tree(r),r}).catch(function(){var e=Object.assign({},t,{url:void 0});return i.tile2tree(e),e})},e.isRequireFetch=function(t){var e=this;return!t.every(function(t){return e.treeIncludesTile(t)})},e.setTileUrlFromTree=function(t){var e=this;return t.filter(function(t){return e.treeIncludesTile(t)}).map(function(t){return Object.assign({},t,{url:e.tileTree[t.z][t.x][t.y]})})},e.updateTiles=function(){var t=p()(g.a.mark(function t(e){var i,r,n,a=this;return g.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.setTileUrlFromTree(e.filter(function(t){return a.treeIncludesTile(t)})),r=e.filter(function(t){return!a.treeIncludesTile(t)}),t.next=4,this.fetchTiles(r);case 4:return n=t.sent,t.abrupt("return",[].concat(i,n));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t}(),m=i(268),I=i(269),T=Object(m.b)(I.a).domain([1e3,0]),M=Object(m.a)().domain([0,1e3]).range([0,8]).exponent(.5),S=function(t){var e=t.feature,i=t.projection,r=e.properties.val,n=i(e.geometry.coordinates),s=Math.abs(M(r)*Math.max(1,i.scale()/125e3));return Object(a.d)("rect",{fill:T(r),fillOpacity:.6,x:n[0]-s/2,y:n[1]-s/2,width:s,height:s,style:{mixBlendMode:"multiply"}})},v=["0.3333 0.3333 0.3333 0 0","0.3333 0.3333 0.3333 0 0","0.3333 0.3333 0.3333 0 0","0 0 0 1 0"],O=function(t){return Object(a.d)("filter",{id:t.id},Object(a.d)("feColorMatrix",{type:"matrix",values:v.join(" ")}))},w=i(245),x=i.n(w),z=i(344).tile,D=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))||this).state={fetchStatus:"yet"},e._tileSet=new j,e._getTileCoordinates=function(t){var i=e.props,r=i.width,n=i.height;return z().size([1.5*r,1.5*n]).scale(2*t.scale()*Math.PI*1.5).translate(t([0,0]).map(function(t){return 1.5*t}))().map(function(t,e,i){return Object.assign({},t,{mag:1.5,id:t.z+"/"+t.x+"/"+t.y,scale:i.scale,translate:i.translate})})},e._fetchTiles=function(t){return e._tileSet.updateTiles(t)},e}n()(e,t);var i=e.prototype;return i.componentDidMount=function(){},i.render=function(){var t=this,e=this.props,i=e.classes,r=e.buffers,n=e.geojson,s=e.mapState;console.log(s.bufferVisibility);var o=this.props.width||400,c=this.props.height||400,l=r?Object(h.a)().fitExtent([[10,40],[o-10,c-40]],r[s.zoomLevel]):Object(h.a)(),u=Object(h.b)(l),f=this._getTileCoordinates(l),g=this._tileSet.setTileUrlFromTree(f);return this._tileSet.isRequireFetch(f)&&this._fetchTiles(f).then(function(e){t.setState({fetchStatus:"fetched"})}),Object(a.d)("svg",{className:i.root,width:o,height:c},Object(a.d)("g",null,Object(a.d)(O,{id:"grayscale"}),Object(a.d)("g",{filter:"url(#grayscale)",className:i.tiles,style:{opacity:"fetched"===this.state.fetchStatus?1:0}},g.map(function(t,e){return Object(a.d)("image",{key:e,xlinkHref:t.url,x:(t.x+t.translate[0])*t.scale/t.mag,y:(t.y+t.translate[1])*t.scale/t.mag,width:t.scale/t.mag,height:t.scale/t.mag})}))),s.bufferVisibility?Object(a.d)("g",null,r?r.map(function(t,e){return Object(a.d)("path",{key:e,d:u(t)||void 0,fill:"none",stroke:"rgba(200, 60, 80, 0.2)",strokeWidth:3})}):null):null,s.popVisibility?Object(a.d)("g",{className:i.points,style:{opacity:"fetched"===this.state.fetchStatus?1:0}},n?n.features.map(function(t,e){return"Point"===t.geometry.type?Object(a.d)(S,{key:e,feature:t,projection:l}):null}):null):null,Object(a.d)("g",null,Object(a.d)("image",{xlinkHref:x.a,x:o/2,y:c/2,width:28,height:28,transform:"translate(-14, -26)"})))},e}(s.Component);e.a=c()(function(t){return u()({root:{},tiles:{},buffer:{fill:"none",stroke:t.palette.primary.main,strokeWidth:2},points:{}})})(D)}}]);
//# sourceMappingURL=component---src-pages-map-page-tsx-1dcfb6ac4572fdd3a87a.js.map