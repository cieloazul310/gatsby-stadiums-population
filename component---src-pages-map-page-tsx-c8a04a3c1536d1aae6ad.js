(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{144:function(t,e,r){"use strict";r.r(e);var n=r(9),i=(r(0),r(241)),a=r.n(i),o=r(213),s=r.n(o),c=r(196),l=r.n(c),u=r(151),h=r.n(u),g=r(179),f=r.n(g),d=r(307),p=r(311),y=r(252),j=Object(p.a)([140.46,36.36],5e3,{units:"meters"});e.default=h()(function(t){return f()({root:{},autoSizerWrapper:{height:"calc(100vh - 56px)"}})})(function(t){return Object(n.d)("div",{className:t.classes.root},Object(n.d)(a.a,{position:"static"},Object(n.d)(s.a,null,Object(n.d)(l.a,{variant:"h6"},"Map Page"))),Object(n.d)("div",{className:t.classes.autoSizerWrapper},Object(n.d)(d.a,null,function(t){var e=t.width,r=t.height;return Object(n.d)(y.a,{width:e,height:r,feature:j})})))})},234:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xMiAyQzguMTMgMiA1IDUuMTMgNSA5YzAgNS4yNSA3IDEzIDcgMTNzNy03Ljc1IDctMTNjMC0zLjg3LTMuMTMtNy03LTd6bTAiIGZpbGw9IiMwMDkxRUEiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPHBhdGggZD0iTTEyIDExLjVjLTEuMzggMC0yLjUtMS4xMi0yLjUtMi41czEuMTItMi41IDIuNS0yLjUgMi41IDEuMTIgMi41IDIuNS0xLjEyIDIuNS0yLjUgMi41eiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zdmc+Cg=="},252:function(t,e,r){"use strict";r(55);var n=r(7),i=r.n(n),a=r(9),o=r(0),s=r(151),c=r.n(s),l=r(179),u=r.n(l),h=r(309),g=r(274),f=r.n(g),d=(r(233),r(275)),p=r.n(d),y=(r(38),r(80),r(61),r(81),r(37),r(215),function(){function t(t){void 0===t&&(t={}),this.tileUrl=t.url||"//cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png",this.tileTree={}}var e=t.prototype;return e.treeIncludesTile=function(t){var e=t.x,r=t.y,n=t.z;return this.tileTree.hasOwnProperty(n.toString())&&this.tileTree[n.toString()].hasOwnProperty(e.toString())&&this.tileTree[n.toString()][e.toString()].hasOwnProperty(r.toString())},e.tile2tree=function(t){var e,r,n=t.x,i=t.y,a=t.z,o=t.url;if(this.tileTree.hasOwnProperty(a.toString()))if(this.tileTree[a.toString()].hasOwnProperty(n.toString()))this.tileTree[a.toString()][n.toString()][i.toString()]=o;else{var s;this.tileTree[a.toString()][n.toString()]=((s={})[i.toString()]=o,s)}else this.tileTree[a.toString()]=((r={})[n.toString()]=((e={})[i.toString()]=o,e),r)},e.fetchTiles=function(t){var e=this;return new Promise(function(r){var n=t.map(function(t){return e.fetchTile(t,e.tileUrl)});Promise.all(n).then(function(t){r(t)})})},e.fetchTile=function(t,e){var r=this,n=t.x,i=t.y,a=t.z,o=e.replace("{z}/{x}/{y}",a+"/"+n+"/"+i);return fetch(o).then(function(t){if(!t.ok)throw new Error;return t.blob()}).then(function(e){var n=Object.assign({},t,{url:URL.createObjectURL(e)});return r.tile2tree(n),n}).catch(function(){var e=Object.assign({},t,{url:void 0});return r.tile2tree(e),e})},e.isRequireFetch=function(t){var e=this;return!t.every(function(t){return e.treeIncludesTile(t)})},e.setTileUrlFromTree=function(t){var e=this;return t.filter(function(t){return e.treeIncludesTile(t)}).map(function(t){return Object.assign({},t,{url:e.tileTree[t.z][t.x][t.y]})})},e.updateTiles=function(){var t=p()(f.a.mark(function t(e){var r,n,i,a=this;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.setTileUrlFromTree(e.filter(function(t){return a.treeIncludesTile(t)})),n=e.filter(function(t){return!a.treeIncludesTile(t)}),t.next=4,this.fetchTiles(n);case 4:return i=t.sent,t.abrupt("return",[].concat(r,i));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t}()),j=r(308),b=r(310),m=Object(j.b)(b.a).domain([1e3,0]),I=Object(j.a)().domain([0,1e3]).range([2,8]),T=function(t){var e=t.feature,r=t.projection,n=e.properties.val,i=r(e.geometry.coordinates),o=Math.abs(I(n)*r.scale()/175216);return Object(a.d)("rect",{fill:m(n),fillOpacity:.6,x:i[0]-o/2,y:i[1]-o/2,width:o,height:o,style:{mixBlendMode:"multiply"}})},M=["0.3333 0.3333 0.3333 0 0","0.3333 0.3333 0.3333 0 0","0.3333 0.3333 0.3333 0 0","0 0 0 1 0"],S=function(t){return Object(a.d)("filter",{id:t.id},Object(a.d)("feColorMatrix",{type:"matrix",values:M.join(" ")}))},v=r(234),O=r.n(v),w=r(313).tile,x=function(t){function e(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))||this).state={fetchStatus:"yet"},e._projection=Object(h.a)(),e._tileSet=new y({url:"//cyberjapandata.gsi.go.jp/xyz/slopemap/{z}/{x}/{y}.png"}),e._getTileCoordinates=function(t){var r=e.props,n=r.width,i=r.height;return w().size([1.5*n,1.5*i]).scale(2*t.scale()*Math.PI*1.5).translate(t([0,0]).map(function(t){return 1.5*t}))().map(function(t,e,r){return Object.assign({},t,{mag:1.5,id:t.z+"/"+t.x+"/"+t.y,scale:r.scale,translate:r.translate})})},e._fetchTiles=function(t){return e._tileSet.updateTiles(t)},e}i()(e,t);var r=e.prototype;return r.componentDidMount=function(){console.log("Component Did Mount"),console.log(this.props.geojson)},r.render=function(){var t=this;console.log("Render");var e=this.props,r=e.classes,n=e.width,i=e.height,o=e.feature,s=e.geojson,c=Object(h.a)().fitExtent([[20,20],[n-20,i-20]],o);console.log(c.scale());var l=Object(h.b)(c),u=this._getTileCoordinates(c);console.log(u),console.log(c.scale());var g=this._tileSet.setTileUrlFromTree(u);return this._tileSet.isRequireFetch(u)&&(console.log("Fetch Tiles Starts"),this._fetchTiles(u).then(function(e){t.setState({fetchStatus:"fetched"}),console.log("Fetch Tiles Ends"),console.log(e)})),Object(a.d)("svg",{className:r.root,width:n,height:i},Object(a.d)("g",null,Object(a.d)(S,{id:"grayscale"}),Object(a.d)("g",{filter:"url(#grayscale)",className:r.tiles,style:{opacity:"fetched"===this.state.fetchStatus?1:0}},g.map(function(t,e){return Object(a.d)("image",{key:e,xlinkHref:t.url,x:(t.x+t.translate[0])*t.scale/t.mag,y:(t.y+t.translate[1])*t.scale/t.mag,width:t.scale/t.mag,height:t.scale/t.mag})}))),Object(a.d)("path",{className:r.buffer,d:l(o)||void 0}),Object(a.d)("g",{className:r.points,style:{opacity:"fetched"===this.state.fetchStatus?1:0}},s?s.features.map(function(t,e){return"Point"===t.geometry.type?Object(a.d)(T,{key:e,feature:t,projection:c}):null}):null),Object(a.d)("g",null,Object(a.d)("image",{xlinkHref:O.a,x:n/2,y:i/2,width:28,height:28,transform:"translate(-14, -26)"})))},e}(o.Component);e.a=c()(function(t){return u()({root:{},tiles:{transition:"opacity 1s"},buffer:{fill:"none",stroke:t.palette.primary.main,strokeWidth:2},points:{transition:"opacity 1s .5s"}})})(x)}}]);
//# sourceMappingURL=component---src-pages-map-page-tsx-c8a04a3c1536d1aae6ad.js.map