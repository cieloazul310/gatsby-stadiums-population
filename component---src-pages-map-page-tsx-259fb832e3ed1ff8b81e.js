(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{147:function(t,e,r){"use strict";r.r(e);var i=r(9),n=(r(0),r(266)),o=r.n(n),a=r(199),s=r.n(a),c=r(190),u=r.n(c),l=r(149),h=r.n(l),f=r(181),p=r.n(f),d=r(342),g=r(212);var b=function(t,e,r,i){if(i=i||{},!Object(g.d)(i))throw new Error("options is invalid");var n=i.units,o=i.properties,a=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),s=Object(g.a)(a[0]),c=Object(g.a)(a[1]),u=Object(g.a)(r),l=Object(g.e)(e,n),h=Math.asin(Math.sin(c)*Math.cos(l)+Math.cos(c)*Math.sin(l)*Math.cos(u)),f=s+Math.atan2(Math.sin(u)*Math.sin(l)*Math.cos(c),Math.cos(l)-Math.sin(c)*Math.sin(h)),p=Object(g.i)(f),d=Object(g.i)(h);return Object(g.g)([p,d],o)};var y=function(t,e,r){var i=(r=r||{}).steps||64,n=r.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof r)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be a number");i=i||64,n=n||t.properties||{};for(var o=[],a=0;a<i;a++)o.push(b(t,e,-360*a/i,r).geometry.coordinates);return o.push(o[0]),Object(g.h)([o],n)},j=r(272),m=y([140.46,36.36],5e3,{units:"meters"});e.default=h()(function(t){return p()({root:{},autoSizerWrapper:{height:"calc(100vh - 56px)"}})})(function(t){return Object(i.d)("div",{className:t.classes.root},Object(i.d)(o.a,{position:"static"},Object(i.d)(s.a,null,Object(i.d)(u.a,{variant:"h6"},"Map Page"))),Object(i.d)("div",{className:t.classes.autoSizerWrapper},Object(i.d)(d.a,null,function(t){var e=t.width,r=t.height;return Object(i.d)(j.a,{width:e,height:r,feature:m})})))})},246:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0xMiAyQzguMTMgMiA1IDUuMTMgNSA5YzAgNS4yNSA3IDEzIDcgMTNzNy03Ljc1IDctMTNjMC0zLjg3LTMuMTMtNy03LTd6bTAiIGZpbGw9IiMwMDkxRUEiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPgogICAgPHBhdGggZD0iTTEyIDExLjVjLTEuMzggMC0yLjUtMS4xMi0yLjUtMi41czEuMTItMi41IDIuNS0yLjUgMi41IDEuMTIgMi41IDIuNS0xLjEyIDIuNS0yLjUgMi41eiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zdmc+Cg=="},272:function(t,e,r){"use strict";r(192),r(55);var i=r(7),n=r.n(i),o=r(9),a=r(0),s=r(149),c=r.n(s),u=r(181),l=r.n(u),h=r(346),f=r(343),p=r(293),d=r.n(p),g=(r(245),r(294)),b=r.n(g),y=(r(38),r(80),r(61),r(81),r(37),r(295),r(296)),j=r.n(y),m=function(){function t(t){void 0===t&&(t={}),this.tileUrl=t.url||"//cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png",this.tileTree={}}var e=t.prototype;return e.treeIncludesTile=function(t){var e=t.x,r=t.y,i=t.z;return this.tileTree.hasOwnProperty(i.toString())&&this.tileTree[i.toString()].hasOwnProperty(e.toString())&&this.tileTree[i.toString()][e.toString()].hasOwnProperty(r.toString())},e.tile2tree=function(t){var e,r,i=t.x,n=t.y,o=t.z,a=t.url;if(this.tileTree.hasOwnProperty(o.toString()))if(this.tileTree[o.toString()].hasOwnProperty(i.toString()))this.tileTree[o.toString()][i.toString()][n.toString()]=a;else{var s;this.tileTree[o.toString()][i.toString()]=((s={})[n.toString()]=a,s)}else this.tileTree[o.toString()]=((r={})[i.toString()]=((e={})[n.toString()]=a,e),r)},e.fetchTiles=function(t){var e=this;return new Promise(function(r){var i=t.map(function(t){return e.fetchTile(t,e.tileUrl)});Promise.all(i).then(function(t){r(t)})})},e.fetchTile=function(t,e){var r=this,i=t.x,n=t.y,o=t.z,a=e.replace("{z}/{x}/{y}",o+"/"+i+"/"+n);return j()(a).then(function(t){if(!t.ok)throw new Error;return t.blob()}).then(function(e){var i=Object.assign({},t,{url:URL.createObjectURL(e)});return r.tile2tree(i),i}).catch(function(){var e=Object.assign({},t,{url:void 0});return r.tile2tree(e),e})},e.isRequireFetch=function(t){var e=this;return!t.every(function(t){return e.treeIncludesTile(t)})},e.setTileUrlFromTree=function(t){var e=this;return t.filter(function(t){return e.treeIncludesTile(t)}).map(function(t){return Object.assign({},t,{url:e.tileTree[t.z][t.x][t.y]})})},e.updateTiles=function(){var t=b()(d.a.mark(function t(e){var r,i,n,o=this;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.setTileUrlFromTree(e.filter(function(t){return o.treeIncludesTile(t)})),i=e.filter(function(t){return!o.treeIncludesTile(t)}),t.next=4,this.fetchTiles(i);case 4:return n=t.sent,t.abrupt("return",[].concat(r,n));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),t}(),M=r(269),O=r(270),w=Object(M.b)(O.a).domain([1e3,0]),v=Object(M.a)().domain([0,1e3]).range([0,8]).exponent(.5),I=function(t){var e=t.feature,r=t.projection,i=e.properties.val,n=r(e.geometry.coordinates),a=Math.abs(v(i)*Math.max(1,r.scale()/125e3));return Object(o.d)("rect",{fill:w(i),fillOpacity:.6,x:n[0]-a/2,y:n[1]-a/2,width:a,height:a,style:{mixBlendMode:"multiply"}})},T=["0.3333 0.3333 0.3333 0 0","0.3333 0.3333 0.3333 0 0","0.3333 0.3333 0.3333 0 0","0 0 0 1 0"],S=function(t){return Object(o.d)("filter",{id:t.id},Object(o.d)("feColorMatrix",{type:"matrix",values:T.join(" ")}))},x=r(246),z=r.n(x),P=r(345).tile,N=function(t){function e(){for(var e,r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))||this).state={fetchStatus:"yet"},e._tileSet=new m,e._getTileCoordinates=function(t){var r=e.props,i=r.width,n=r.height;return P().size([1.5*i,1.5*n]).scale(2*t.scale()*Math.PI*1.5).translate(t([0,0]).map(function(t){return 1.5*t}))().map(function(t,e,r){return Object.assign({},t,{mag:1.5,id:t.z+"/"+t.x+"/"+t.y,scale:r.scale,translate:r.translate})})},e._fetchTiles=function(t){return e._tileSet.updateTiles(t)},e}n()(e,t);var r=e.prototype;return r.componentDidMount=function(){},r.render=function(){var t=this,e=this.props,r=e.classes,i=e.buffers,n=e.geojson,a=e.mapState;console.log(i[0].properties.name,a.hasOwnProperty("popVisibility"),a.hasOwnProperty("bufferVisibility"),a.hasOwnProperty("zoomLevel"));var s=a.popVisibility,c=a.bufferVisibility,u=a.zoomLevel,l=this.props.width||400,p=this.props.height||400,d=i?Object(f.a)().fitExtent([[10,40],[l-10,p-40]],i[u]):Object(f.a)(),g=Object(f.b)(d),b=this._getTileCoordinates(d),y=this._tileSet.setTileUrlFromTree(b);return this._tileSet.isRequireFetch(b)&&this._fetchTiles(b).then(function(e){t.setState({fetchStatus:"fetched"})}),Object(o.d)("svg",{className:r.root,width:l,height:p},Object(o.d)("g",null,Object(o.d)(S,{id:"grayscale"}),Object(o.d)("g",{filter:"url(#grayscale)",className:r.tiles,style:{opacity:"fetched"===this.state.fetchStatus?1:0}},y.map(function(t,e){return Object(o.d)("image",{key:e,xlinkHref:t.url,x:(t.x+t.translate[0])*t.scale/t.mag,y:(t.y+t.translate[1])*t.scale/t.mag,width:t.scale/t.mag,height:t.scale/t.mag})}))),s?Object(o.d)("g",{className:r.points,style:{opacity:"fetched"===this.state.fetchStatus?1:0}},n?n.features.map(function(t,e){return"Point"===t.geometry.type?Object(o.d)(I,{key:e,feature:t,projection:d}):null}):null):null,c?Object(o.d)("g",null,i?i.map(function(t,e){var i=Object(h.a)(t),n=d([i[2]+(i[0]-i[2])/2,i[1]]);return Object(o.d)("g",{key:e,className:r.buffer},Object(o.d)("path",{d:g(t)||void 0,fill:"none",stroke:"rgb(200, 60, 80)",strokeWidth:3}),Object(o.d)("text",{x:n[0],y:n[1],dy:"1em",textAnchor:"middle",fill:"rgb(200, 60, 80)",style:{fontWeight:"bold"}},t.properties.radius))}):null):null,Object(o.d)("g",null,Object(o.d)("image",{xlinkHref:z.a,x:l/2,y:p/2,width:28,height:28,transform:"translate(-14, -26)"})))},e}(a.Component);e.a=c()(function(t){return l()({root:{},tiles:{},buffer:{opacity:.2,"&:hover":{opacity:1}},points:{}})})(N)}}]);
//# sourceMappingURL=component---src-pages-map-page-tsx-259fb832e3ed1ff8b81e.js.map